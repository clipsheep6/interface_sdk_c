# Copyright (c) 2019-2024 Huawei Device Co., Ltd. All rights reserved.

import("//build/ohos.gni")
import("//build/ohos/ndk/ndk.gni")

ohos_ndk_headers("zlib_header") {
  sources = [
    "./zconf.h",
    "./zlib.h",
  ]
}

ohos_ndk_library("libz_ndk") {
  output_name = "z"
  ndk_description_file = "./zlib.ndk.json"
  output_extension = "so"
}

ohos_copy("zlib_ndk_libs_aarch64") {
  deps = [ "//third_party/zlib:libz(//build/toolchain/ohos:ohos_clang_arm64)" ]
  sources = [ get_label_info(deps[0], "target_out_dir") + "/libz.a" ]
  outputs = [ "$ndk_os_irrelevant_out_dir/sysroot/usr/lib/aarch64-linux-ohos/{{source_file_part}}" ]
}

ohos_copy("zlib_ndk_libs_arm32") {
  deps = [ "//third_party/zlib:libz(//build/toolchain/ohos:ohos_clang_arm)" ]
  sources = [ get_label_info(deps[0], "target_out_dir") + "/libz.a" ]
  outputs = [ "$ndk_os_irrelevant_out_dir/sysroot/usr/lib/arm-linux-ohos/{{source_file_part}}" ]
}

ohos_copy("zlib_ndk_libs_x86_64") {
  deps = [ "//third_party/zlib:libz(//build/toolchain/ohos:ohos_clang_x86_64)" ]
  sources = [ get_label_info(deps[0], "target_out_dir") + "/libz.a" ]
  outputs = [ "$ndk_os_irrelevant_out_dir/sysroot/usr/lib/x86_64-linux-ohos/{{source_file_part}}" ]
}